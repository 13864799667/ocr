# 如何添加新的OCR识别指标

## 📍 修改文件位置

**文件**: `batch_folder_process.py`  
**位置**: 第 715-733 行  
**变量**: `COORDINATE_DATA_ENHANCED`

## 📝 坐标格式

```
_part_编号 指标名称 x1,y1，x2,y2
```

### 参数说明：
- `_part_编号`: 图片分割后的部分编号（如 _part_2, _part_13）
- `指标名称`: 要识别的特征名称（会作为Excel列名）
- `x1,y1`: 识别区域的左上角坐标
- `x2,y2`: 识别区域的右下角坐标

## ✏️ 添加步骤

### 1. 确定图片部分编号
首先确定你要识别的内容在哪个分割后的图片部分：
- `_part_2`: 体重
- `_part_3`: 体脂率
- `_part_13`: 节段肌肉
- 等等...

### 2. 获取坐标
使用图片查看工具（如Photoshop、GIMP）获取识别区域的坐标：
- 左上角坐标 (x1, y1)
- 右下角坐标 (x2, y2)

### 3. 添加到配置中

在 `batch_folder_process.py` 的 `COORDINATE_DATA_ENHANCED` 中添加新行：

```python
COORDINATE_DATA_ENHANCED = """
_part_2 体重(kg) 41,57，139,107	
_part_3 体脂率(%) 38,27，136,75	
_part_4 骨骼肌(kg) 39,26，142,76	
# ... 现有配置 ...

# 添加新指标（示例）
_part_19 肌肉量(kg) 100,50，200,100
_part_20 新指标名称 x1,y1，x2,y2
"""
```

## 📋 当前已配置的指标

```
_part_2  → 体重(kg)
_part_3  → 体脂率(%)
_part_4  → 骨骼肌(kg)
_part_5  → 水分含量(kg), 蛋白质(kg), 无机盐(kg)
_part_7  → 浮肿评估
_part_11 → BMI
_part_13 → 节段肌肉(kg)-左臂/右臂/躯干/左腿/右腿
_part_15 → 腰臀比
_part_16 → 内脏脂肪等级
_part_17 → 基础代谢(kcal/day)
_part_18 → 健康分数
```

## 🔍 如何确定坐标

### 方法1: 使用图片编辑软件
1. 用Photoshop/GIMP打开分割后的图片
2. 使用矩形选择工具框选要识别的区域
3. 查看选区的坐标信息

### 方法2: 使用Python脚本
```python
from PIL import Image
import matplotlib.pyplot as plt

# 打开图片
img = Image.open('your_image.jpg')

# 显示图片并获取坐标
plt.imshow(img)
plt.show()

# 点击图片可以看到坐标
```

### 方法3: 使用在线工具
- 上传图片到在线坐标获取工具
- 点击获取像素坐标

## ⚠️ 注意事项

1. **坐标精度**: 确保坐标准确框选文字区域，留一点边距
2. **分辨率一致**: 所有图片应该是相同分辨率
3. **中英文逗号**: 坐标中可以使用中文逗号（，）或英文逗号（,）
4. **同一part多个指标**: 同一个_part可以有多个指标（如_part_5有3个）
5. **指标名称**: 建议使用有意义的名称，会直接显示在Excel中

## 🧪 测试新指标

添加新指标后，建议：

1. 先用一个测试文件夹测试
2. 检查生成的Excel是否包含新列
3. 检查roi_images中是否有对应的截图
4. 验证识别结果是否准确

## 📂 相关文件

如果需要在其他脚本中也使用相同配置：

- `one_key_process.py` (第1146行)
- `improved_one_key_process.py` (如果使用)
- `参考坐标区域.txt` (参考文件)

建议保持所有文件的坐标配置一致。
